# Structure From Motion (SfM) reconstruction library

This library provides a toolset to perform SfM reconstructions on the Photo Tourism dataset (or datasets with similar formats)


## Requeriments
This library is tested using Python 3.6.8. The full list of packages can be found in `requirements.txt`. 

### Dataset requeriments
This library is developed to be used in the Photo Tourism dataset or datasets with a similar format. The command line tool is given the path to the `*.out` file generated by [Bundler](http://www.cs.cornell.edu/~snavely/bundler/bundler-v0.3-manual.html#S6) and must follow the same file structure:
```
<dataset_folder>
├── images
├── list.txt
└── <bundle_file>.out
```

## Basic usage

Some basic commands that can be performed using this library are:

- Reconstruction using two images, view on a window and save the result on the file `reconstruction.ply`.

```bash
$ python sfm.py --path <*.out path> --images 0 1 --view --save reconstuction.ply
```

- Reconstruction using five images on a pairwise reconstruction, view on a window and save the result on the file `reconstruction.ply`.

```bash
$ python sfm.py --path <*.out path> --images 0 1 2 3 4 --view --method pair --save reconstuction.ply
```

- Reconstruction using five images on a bundle reconstruction, view on a window and save the result on the file `reconstruction.ply`.

```bash
$ python sfm.py --path <*.out path> --images 0 1 2 3 4 --view --method pair --save reconstuction.ply
```


## Parameters
The full list of parameters can be found using `python sfm.py --help`.
```       
usage: sfm.py [-h] [--path PATH] [--images IMAGES [IMAGES ...]]
              [--reconstruction_type RECONSTRUCTION_TYPE]
              [--reconstruction_method RECONSTRUCTION_METHOD] [--view]
              [--save SAVE]

Process some integers.

optional arguments:
  -h, --help            show this help message and exit
  --path PATH           Path containing the dataset
  --images IMAGES [IMAGES ...]
                        Input images to the SfM algorithm (int indexes). The
                        method will fail if a number larger than the dataset
                        size is specified
  --reconstruction_type RECONSTRUCTION_TYPE
                        Type of reconstruction: 'dense' or 'sparse'. Defaults
                        to 'sparse'
  --reconstruction_method RECONSTRUCTION_METHOD
                        Method to perform the reconstruction: either 'pair' or
                        'bundle'. Defaults to 'bundle'
  --view                View the resulting point cloud in an interface (
  --save SAVE           View the resulting point cloud in an interface (
```


## Changelog 

V0.1 - Initial version with only sparse reconstruction working.